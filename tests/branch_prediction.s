######### Generated by Gemini and other AI models #########


#############
# static branch prediction and dynamic branch prediction is better than no branch prediction
# demonstrate with fowarding + hazard detection
.text
main:
    addi x31,x0,5
    loop:
    beq x31,x30,exit
        addi x1, x1, 10
        addi x2, x2, 10      # x1 == x2
        
        # The Branch
        # Condition is False (10 != 10 is False). We do NOT jump.
        bne  x1, x2, failure 
        
        # Correct Path (Static Predicts this immediately)
        addi x3, x3, 5       # Should run instantly
        addi x4, x4, 6
    addi x30,x30,1
    beq x0,x0,loop
    
    nop
    nop
    nop
    beq x0,x0,exit

failure:
    addi x30, x0, 999
    ecall

exit:
    nop
    nop
    nop
    nop



############
.text
main:
    # A bit pattern that has no obvious T/NT repetition
    # Binary: 1011 0100 (Taken, NT, Taken, Taken, NT, Taken, NT, NT...)
    addi x1, x0, 180     
    addi x2, x0, 8       # 8 bits to process
    addi x3, x0, 1       # Mask

loop:
    beq  x2, x0, end     # If 8 bits done, exit
    
    and  x4, x1, x3      # Get LSB (Least Significant Bit)
    srli x1, x1, 1       # Shift pattern right
    addi x2, x2, -1      # Decrement counter
    
    # The Chaos Branch
    # jumps if bit was 0. 
    # Since bits are random, prediction is basically a coin flip.
    beq  x4, x0, is_zero 
    
is_one:
    addi x5, x5, 1       # Track ones
    jal  x0, loop

is_zero:
    addi x6, x6, 1       # Track zeros
    jal  x0, loop

end:
    nop
    nop
    nop
    nop